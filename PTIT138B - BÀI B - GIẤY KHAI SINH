#include <bits/stdc++.h>
#define endl "\n"
using namespace std;
struct data
{
    string bo;
    string con;
    int tuoi;
    int de;
};
bool cmp(struct data a, struct data b)
{
    if (a.tuoi == b.tuoi)
        return a.con < b.con;
        return a.tuoi > b.tuoi;
}
int n;
struct data a[102];
void Try(string x, int kc)
{
    for (int i = 0; i < n; i++)
    {
        if (a[i].bo == x)
        {
            if (a[i].bo == "Ted")
            {
                a[i].tuoi = 100 - a[i].de;
                Try(a[i].con, 100 - a[i].de);
            }
            else
            {
                a[i].tuoi = kc - a[i].de;
                Try(a[i].con, kc - a[i].de);
            }
        }
    }
}
int main()
{
    ios_base::sync_with_stdio(0);
    cin.tie(0);
    int t;
    cin >> t;
    for (int k = 1; k <= t; k++)
    {
        cin >> n;
        for (int i = 0; i < n; i++)
            cin >> a[i].bo >> a[i].con >> a[i].de;
        Try("Ted", 0);
        sort(a, a + n, cmp);
        cout << "DATASET " << k << endl;
        for (int i = 0; i < n; i++)
            cout << a[i].con << " " << a[i].tuoi << endl;
    }
}
/* Do Xuan Huong
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@##################@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@#############################@@@@@@@@@@@@@@@@
@@@@@@@@@@@@&####################################@@@@@@@@@@@@
@@@@@@@@@@##########################################@@@@@@@@@
@@@@@@@@##############################################@@@@@@@
@@@@@@#################################################@@@@@@
@@@@@####################################################@@@@
@@@%#####################@@@@@@@@@@@######################@@@
@@@###################@@@@@@@@@@@@@@@@@####################@@
@@##################@@@@@@         @@@@@@##################@@
@@#################@@@@@             @@@@###################@
@@@@@@@@@@@@@@@@@@@@@@@@             @@@@@@@@@@@@@@@@@@@@@@@@
@                  &@@@@             @@@@           .......@@
@@                  @@@@@@         @@@@@@           .......@@
@@                    @@@@@@@@@@@@@@@@@            .......@@@
@@@                      @@@@@@@@@@@               ......@@@@
@@@@                                              ......@@@@@
@@@@@@                                           ......@@@@@@
@@@@@@@                                         .....@@@@@@@@
@@@@@@@@@                                     .....@@@@@@@@@@
@@@@@@@@@@@@                                ....@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@                         ....@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@%                .@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
*/
